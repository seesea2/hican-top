import{d as B,r as v,c as n,a as f,b as e,w as y,v as S,u as a,e as C,t as u,f as p,F as h,g as N,h as w,i as k,o as i}from"./index-a9084e4b.js";import{a as I,N as A}from"./Navbar-21b9960e.js";import{g as T,r as $}from"./busBookmarks-e2b89998.js";const x={class:"container pt-3 pb-5"},V={class:"text-center"},D=e("h2",null,"Bus Arrival Time",-1),E=e("h6",null,"Get bus arrival time by bus stop code.",-1),R={class:"row justify-content-center mx-0 mt-4"},L={class:"col-12 col-md-6 col-lg-4"},O={class:"input-group"},P={class:"input-group-append"},G={key:0},M={key:0,class:"mt-4"},U=e("h3",null,"Bus Stop Bookmark",-1),W={class:"table table-sm mt-2"},q=e("thead",{class:"thead-dark"},[e("tr",null,[e("th",{scope:"col"},"BusStop"),e("th",{scope:"col"},"Name"),e("th",{scope:"col"},"Remove")])],-1),F=["onClick"],K=["onClick"],j=["onClick"],X={class:"mt-4"},z={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},H=e("span",{class:"visually-hidden"},"Loading...",-1),J=[H],Q={key:1,class:"table table-sm mt-2"},Y=e("thead",{class:"thead-dark"},[e("tr",null,[e("th",{scope:"col"},"BusStop"),e("th",{scope:"col"},"Name")])],-1),Z=["onClick"],tt=["onClick"],lt=B({__name:"BusArrival",setup(et){document.title="Bus Arrival";let t=v({inputCode:"",inputNote:"",loadingNearbyBusStops:!1,showNearbyBusStops:!1,getNearbyNote:"",watchId:0}),b=v([]),c=v([]);_();function r(s){if(s&&(t.value.inputCode=s.trim()),!t.value.inputCode){t.value.inputNote="Please input bus stop code.";return}t.value.inputNote="",t.value.showNearbyBusStops=!1,t.value.watchId&&(navigator.geolocation.clearWatch(t.value.watchId),t.value.watchId=0),k.push({name:"BusArrivalTime",params:{inputCode:t.value.inputCode}})}function _(){c.value=T()}function g(s){$(s)&&_()}function m(){if(t.value.getNearbyNote="",t.value.showNearbyBusStops){t.value.showNearbyBusStops=!1,t.value.watchId&&(navigator.geolocation.clearWatch(t.value.watchId),t.value.watchId=0);return}t.value.loadingNearbyBusStops=!0,navigator&&navigator.geolocation&&(t.value.watchId=navigator.geolocation.watchPosition(s=>{s&&s.coords&&I.get("/api/lta/bus/nearbyBusStops",{params:{latitude:s.coords.latitude,longitude:s.coords.longitude}}).then(l=>{b.value=l.data,t.value.showNearbyBusStops=!0}).catch(l=>{console.log(l)}).finally(()=>{t.value.loadingNearbyBusStops=!1})},s=>{switch(t.value.loadingNearbyBusStops=!1,t.value.showNearbyBusStops=!1,t.value.watchId&&(navigator.geolocation.clearWatch(t.value.watchId),t.value.watchId=0),s.code){case s.PERMISSION_DENIED:t.value.getNearbyNote="Request for Geolocation is denied.";break;case s.POSITION_UNAVAILABLE:t.value.getNearbyNote="Location information is unavailable.";break;case s.TIMEOUT:t.value.getNearbyNote="Request to get location timed out.";break;default:t.value.getNearbyNote="An unknown error occurred.";break}}))}return(s,l)=>(i(),n(h,null,[f(A),e("div",x,[e("div",V,[D,E,e("div",R,[e("div",L,[e("div",O,[y(e("input",{"onUpdate:modelValue":l[0]||(l[0]=o=>a(t).inputCode=o),placeholder:"Bus stop code",class:"form-control",onKeyup:l[1]||(l[1]=C(o=>r(a(t).inputCode),["enter"]))},null,544),[[S,a(t).inputCode,void 0,{trim:!0}]]),e("div",P,[e("button",{class:"btn btn-primary",onClick:l[2]||(l[2]=o=>r(a(t).inputCode))}," Get ")])]),a(t).inputNote?(i(),n("div",G,u(a(t).inputNote),1)):p("",!0)])]),a(c)&&a(c).length?(i(),n("div",M,[U,e("table",W,[q,e("tbody",null,[(i(!0),n(h,null,N(a(c),o=>(i(),n("tr",{key:o.BusStopCode},[e("td",null,[e("a",{onClick:d=>r(o.BusStopCode),class:"btn"},u(o.BusStopCode),9,F)]),e("td",null,[e("a",{onClick:d=>r(o.BusStopCode),class:"btn"},u(o.Description)+"@"+u(o.RoadName),9,K)]),e("td",null,[e("a",{onClick:d=>g(o.BusStopCode),class:"btn"},"X",8,j)])]))),128))])])])):p("",!0),e("div",X,[e("button",{onClick:l[3]||(l[3]=o=>m()),class:"btn btn-primary"},[w(" Toggle Nearby Bus Stops "),a(t).loadingNearbyBusStops?(i(),n("span",z,J)):p("",!0)]),e("div",null,u(a(t).getNearbyNote),1)]),a(t).showNearbyBusStops?(i(),n("table",Q,[Y,e("tbody",null,[(i(!0),n(h,null,N(a(b),o=>(i(),n("tr",{key:o.busStop.BusStopCode},[e("td",null,[e("a",{onClick:d=>r(o.busStop.BusStopCode),class:"btn"},u(o.busStop.BusStopCode),9,Z)]),e("td",null,[e("a",{onClick:d=>r(o.busStop.BusStopCode),class:"btn"},u(o.busStop.Description)+"@"+u(o.busStop.RoadName),9,tt)])]))),128))])])):p("",!0)])])],64))}});export{lt as default};
