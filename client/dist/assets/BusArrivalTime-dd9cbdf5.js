var w=Object.defineProperty;var x=(d,i,e)=>i in d?w(d,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[i]=e;var v=(d,i,e)=>(x(d,typeof i!="symbol"?i+"":i,e),e);import{a as L}from"./axios-4a70c6fc.js";import{d as D,r as f,j as E,c as s,b as t,u as n,t as u,f as c,F as y,g as N,o as l,n as h}from"./index-a59befc7.js";import{a as S,b as $,B as C}from"./busBookmarks-e2b89998.js";const F={class:"container text-center py-3"},O={key:0},R={key:1,class:"my-3"},T=t("div",{class:"spinner-border",style:{width:"10rem",height:"10rem"},role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),V=[T],j={key:2},z={key:0,class:"table mt-3"},M=t("thead",{class:"thead-dark"},[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"1st Bus"),t("th",{scope:"col"},"2nd Bus"),t("th",{scope:"col"},"3rd Bus")])],-1),q={key:0},G={scope:"row"},H={key:1},I=t("caption",null,[t("ul",{class:"small"},[t("li",null,[t("label",null,"Seats Available")]),t("li",null,[t("label",{class:"bg-info"},"Standing Available")]),t("li",null,[t("label",{class:"bg-warning"},"Limited Standing")])])],-1),J={class:"btn-group mt-3"},W=D({__name:"BusArrivalTime",setup(d){class i{constructor(){v(this,"odata.metadata","");v(this,"BusStopCode","");v(this,"Services",[])}}document.title="Bus Arrival";let e=f({inputCode:"",loading:!1,loadingNote:""}),p=f(new i),m=f(new C),g=f(new C);const B=E();typeof B.params.inputCode=="string"&&(e.value.inputCode=B.params.inputCode),k();function k(){e.value.loading=!0,e.value.loadingNote="",L.get("/api/lta/bus/busArrival/"+e.value.inputCode).then(a=>{m.value=a.data.busStop,p.value=a.data.busArrival,g.value=S(e.value.inputCode)}).catch(a=>{if(a.response&&a.response.data&&a.response.data.message){e.value.loadingNote=a.response.data.message;return}e.value.loadingNote=a}).finally(()=>{e.value.loading=!1})}function b(a){if(!(!a||a.Load=="SEA")){if(a.Load=="SDA")return"bg-info";if(a.Load=="LSD")return"bg-warning"}}function _(a){if(!a||!a.EstimatedArrival)return"NA";const r=new Date(a.EstimatedArrival);if(r.valueOf()-Date.now()<0)return"Arrived";const o=(r.valueOf()-Date.now())/1e3/60;return o<1?"1 min":o.toFixed(0)+" mins"}function A(){$(m.value)&&(g.value=S(e.value.inputCode))}return(a,r)=>(l(),s("div",F,[t("div",null,[n(m)?(l(),s("h3",O,u(n(m).Description),1)):c("",!0),t("h5",null,"Bus Stop: "+u(n(e).inputCode),1),n(e).loading?(l(),s("div",R,V)):n(e).loadingNote?(l(),s("div",j,u(n(e).loadingNote),1)):c("",!0)]),n(p).BusStopCode?(l(),s("table",z,[M,n(p).Services.length?(l(),s("tbody",q,[(l(!0),s(y,null,N(n(p).Services,o=>(l(),s("tr",{key:o.ServiceNo},[t("th",G,u(o.ServiceNo),1),t("td",{class:h(b(o.NextBus))},u(_(o.NextBus)),3),t("td",{class:h(b(o.NextBus2))},u(_(o.NextBus2)),3),t("td",{class:h(b(o.NextBus2))},u(_(o.NextBus3)),3)]))),128))])):(l(),s("tbody",H,[t("tr",null,[(l(),s(y,null,N(4,o=>t("td",{key:o},"NA")),64))])])),I])):c("",!0),t("div",J,[n(e).loadingNote?c("",!0):(l(),s("button",{key:0,onClick:r[0]||(r[0]=o=>k()),class:"btn btn-primary"}," Refresh ")),!n(e).loadingNote&&!n(g)?(l(),s("button",{key:1,onClick:r[1]||(r[1]=o=>A()),class:"btn btn-primary"}," BookmarkBusStop ")):c("",!0),t("button",{class:"btn btn-primary",onClick:r[2]||(r[2]=o=>a.$router.go(-1))},"Back")])]))}});export{W as default};
